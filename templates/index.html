<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartWaste AI â€” Noida</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
    <div>
        <h1>ğŸ—‘ï¸ SmartWaste AI</h1>
        <span>Noida Municipal Waste Management System</span>
    </div>
    <div style="display:flex;gap:15px;align-items:center;">
        <span id="last-updated" style="font-size:12px;color:#6b7280;"></span>
        <span class="live-badge">â— LIVE</span>
    </div>
</div>

<!-- STATS -->
<div class="stats">
    <div class="stat-card">
        <div class="number" id="total-bins">6</div>
        <div class="label">Total Bins</div>
    </div>
    <div class="stat-card">
        <div class="number" id="critical-bins" style="color:#ef4444;">0</div>
        <div class="label">Critical (>80%)</div>
    </div>
    <div class="stat-card">
        <div class="number" id="avg-fill" style="color:#f59e0b;">0%</div>
        <div class="label">Average Fill Level</div>
    </div>
    <div class="stat-card">
        <div class="number" id="alerts-sent" style="color:#3b82f6;">0</div>
        <div class="label">Alerts Sent Today</div>
    </div>
</div>

<!-- MAIN GRID -->
<div class="main-grid">

    <!-- MAP -->
    <div class="map-container">
        <div class="section-title">
            <span>ğŸ“ Live Bin Map â€” Noida</span>
            <span id="map-status" style="font-size:12px;color:#10b981;">Tracking 6 bins</span>
        </div>
        <div id="map"></div>
    </div>

    <!-- BIN CARDS -->
    <div class="bins-container">
        <div class="section-title">
            <span>ğŸ—‘ï¸ Bin Status</span>
            <button class="btn btn-green" style="width:auto;padding:6px 14px;margin:0;font-size:12px;" onclick="loadBins()">â†» Refresh</button>
        </div>
        <div class="bin-list" id="bin-list">
            <p style="color:#6b7280;text-align:center;padding:20px;">Loading bins...</p>
        </div>
    </div>

</div>

<!-- BOTTOM GRID -->
<div class="bottom-grid">

    <!-- AI FILL DETECTION -->
    <div class="upload-section">
        <div class="section-title">ğŸ“· AI Fill Detection</div>
        <div class="upload-area">
            <select id="bin-select">
                <option value="">Select Bin...</option>
            </select>
            <label class="upload-label" for="image-upload">
                <span style="font-size:30px;">ğŸ“¸</span>
                <p>Click to upload bin image</p>
                <p style="font-size:11px;">AI will detect fill level automatically</p>
            </label>
            <input type="file" id="image-upload" accept="image/*" onchange="previewImage(this)">
            <img id="preview" style="max-width:100%;border-radius:8px;display:none;margin-bottom:10px;">
            <button class="btn btn-green" onclick="detectFill()">ğŸ” Detect Fill Level</button>
            <button class="btn btn-red" onclick="sendAlert()">ğŸš¨ Send WhatsApp Alert</button>
            <div class="result-box" id="detect-result"></div>
        </div>
    </div>

    <!-- ROUTE OPTIMIZER -->
    <div class="route-section">
        <div class="section-title">
            <span>ğŸš› Optimized Collection Route</span>
        </div>
        <div style="padding:15px;">
            <button class="btn btn-blue" onclick="optimizeRoute()">âš¡ Generate Optimal Route</button>
        </div>
        <div class="route-summary" id="route-summary"></div>
        <div class="route-list" id="route-list">
            <p style="color:#6b7280;font-size:13px;padding:10px;">Click button to generate optimized route for all critical bins.</p>
        </div>
    </div>

</div>

<!-- SCRIPTS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="/static/js/map.js"></script>
<script src="/static/js/dashboard.js"></script>

</body>
</html>